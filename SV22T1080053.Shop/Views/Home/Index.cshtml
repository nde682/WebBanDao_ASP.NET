@model HomeIndexModel
<body>
    <!-- Carousel Start -->
    <div class="container-fluid carousel bg-light px-0">
        <div class="row g-0 justify-content-end">
            <div class="col-12 col-lg-7 col-xl-9">
                <div class="header-carousel owl-carousel bg-light py-5">
                    <div class="row g-0 header-carousel-item align-items-center">
                        <div class="col-xl-6 carousel-img wow fadeInLeft" data-wow-delay="0.1s">
                            <img src="~/themes/img/banner-1.jpg" class="img-fluid w-100" alt="Image">
                        </div>
                        <div class="col-xl-6 carousel-content p-4">
                            <h4 class="text-uppercase fw-bold mb-4 wow fadeInRight" data-wow-delay="0.1s"
                                style="letter-spacing: 3px;">
                                Sắc bén vượt trội, nâng tầm trải nghiệm nấu ăn.
                            </h4>
                            <h1 class="display-3 text-capitalize mb-4 wow fadeInRight" data-wow-delay="0.3s">
                                An toàn
                                Dễ sử dụng cho mọi gian bếp.
                            </h1>
                            <p class="text-dark wow fadeInRight" data-wow-delay="0.5s">Còn chờ gì nữa</p>
                            <a class="btn btn-primary rounded-pill py-3 px-5 wow fadeInRight" data-wow-delay="0.7s"
                               href="#">Mua Ngay</a>
                        </div>
                    </div>
                    <div class="row g-0 header-carousel-item align-items-center">
                        <div class="col-xl-6 carousel-img wow fadeInLeft" data-wow-delay="0.1s">
                            <img src="~/themes/img/banner-2.jpg" class="img-fluid w-100" alt="Image">
                        </div>
                        <div class="col-xl-6 carousel-content p-4">
                            <h4 class="text-uppercase fw-bold mb-4 wow fadeInRight" data-wow-delay="0.1s"
                                style="letter-spacing: 3px;">
                                Chọn dao tốt, chọn chất lượng
                            </h4>
                            <h1 class="display-3 text-capitalize mb-4 wow fadeInRight" data-wow-delay="0.3s">
                                Dao sắc, bếp gọn, nấu ăn nhàn hơn mỗi ngày.
                            </h1>
                            <p class="text-dark wow fadeInRight" data-wow-delay="0.5s">Còn chờ gì nữa</p>
                            <a class="btn btn-primary rounded-pill py-3 px-5 wow fadeInRight" data-wow-delay="0.7s"
                               href="#">Mua Ngay</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-12 col-lg-5 col-xl-3 wow fadeInRight" data-wow-delay="0.1s">
                <div class="carousel-header-banner h-100">
                    @{
                        string imgpath = ApplicationContext.ProductImagePath + Model.Bestseller.Photo;
                    }
                    <img src="@imgpath" class="img-fluid w-100 h-100" style="object-fit: cover;" alt="Image">
                    <div class="carousel-banner-offer">
                        <p class="text-primary fs-5 fw-bold mb-0">Special Offer</p>
                    </div>
                    <div class="carousel-banner">
                        <div class="carousel-banner-content text-center p-4">
                            <a href="#" class="d-block mb-2">@Model.Bestseller.ProductName</a>
                            <a href="#" class="d-block text-white fs-3">@Model.Bestseller.ProductDescription</a>
                            <span class="text-primary fs-5 inputmask-numeric">@Model.Bestseller.Price</span> VNĐ
                        </div>
                        <a href="javascript:;" onclick="addToCart(@Model.Bestseller.ProductID)" class="btn btn-primary rounded-pill py-2 px-4">
                            <i class="fas fa-shopping-cart me-2"></i> Thêm vào giỏ hàng
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Carousel End -->
    <!-- Searvices Start -->
    <div class="container-fluid px-0">
        <div class="row g-0">
            <div class="col-6 col-md-4 col-lg-2 border-start border-end wow fadeInUp" data-wow-delay="0.1s">
                <div class="p-4">
                    <div class="d-inline-flex align-items-center">
                        <i class="fa fa-sync-alt fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">Hỗ trợ đổi trả</h6>
                            <p class="mb-0">Liên hệ chúng tôi để hỗ trợ đổi trả</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2 border-end wow fadeInUp" data-wow-delay="0.2s">
                <div class="p-4">
                    <div class="d-flex align-items-center">
                        <i class="fab fa-telegram-plane fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">Giao hàng tận nơi</h6>
                            <p class="mb-0">Giao hàng tận nơi trên toàn quốc</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2 border-end wow fadeInUp" data-wow-delay="0.3s">
                <div class="p-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-life-ring fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">Hỗ trợ 24/7</h6>
                            <p class="mb-0">Chúng tôi hỗ trợ liên tục trong ngày</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2 border-end wow fadeInUp" data-wow-delay="0.4s">
                <div class="p-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-credit-card fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">Thanh toán online</h6>
                            <p class="mb-0">Thanh toán online mọi nơi</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2 border-end wow fadeInUp" data-wow-delay="0.5s">
                <div class="p-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-lock fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">An toàn thanh toán</h6>
                            <p class="mb-0">Môi trường thanh toán an toàn</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2 border-end wow fadeInUp" data-wow-delay="0.6s">
                <div class="p-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-blog fa-2x text-primary"></i>
                        <div class="ms-4">
                            <h6 class="text-uppercase mb-2">Dịch vụ hỗ trợ</h6>
                            <p class="mb-0">Hỗ trợ tư vấn sản phẩm</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Searvices End -->
    <div class="container-fluid product py-5">
        <div class="container py-5">
            <div class="tab-class">
                <div class="row g-4">
                    <div class="col-lg-6 text-start wow fadeInLeft" data-wow-delay="0.1s">
                        <h1>Sản phẩm của chúng tôi</h1>
                    </div>
                    <div class="col-lg-6 text-end wow fadeInRight" data-wow-delay="0.1s">
                        <ul class="nav nav-pills d-inline-flex text-center mb-5">
                            <li class="nav-item mb-4">
                                <a class="d-flex mx-2 py-2 bg-light rounded-pill active" data-bs-toggle="pill" href="#tab-1">
                                    <span class="text-dark" style="width: 130px;">Tất cả</span>
                                </a>
                            </li>
                            <li class="nav-item mb-4">
                                <a class="d-flex py-2 mx-2 bg-light rounded-pill" data-bs-toggle="pill" href="#tab-2">
                                    <span class="text-dark" style="width: 130px;">Sản phẩm mới</span>
                                </a>
                            </li>
                            <li class="nav-item mb-4">
                                <a class="d-flex mx-2 py-2 bg-light rounded-pill" data-bs-toggle="pill" href="#tab-3">
                                    <span class="text-dark" style="width: 130px;">Giá rẻ nhất</span>
                                </a>
                            </li>
                            <li class="nav-item mb-4">
                                <a class="d-flex mx-2 py-2 bg-light rounded-pill" data-bs-toggle="pill" href="#tab-4">
                                    <span class="text-dark" style="width: 130px;">Bán chạy</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="tab-content">
                    <div id="tab-1" class="tab-pane fade show p-0 active">
                        <div class="row g-4">
                            @foreach (var item in Model.AllProducts)
                            {
                                @await Html.PartialAsync("_ProductItem", item)
                            }
                        </div>
                    </div>

                    <div id="tab-2" class="tab-pane fade show p-0">
                        <div class="row g-4">
                            @foreach (var item in Model.NewestProducts)
                            {
                                @await Html.PartialAsync("_ProductItem", item)
                            }
                        </div>
                    </div>

                    <div id="tab-3" class="tab-pane fade show p-0">
                        <div class="row g-4">
                            @foreach (var item in Model.CheapestProducts)
                            {
                                @await Html.PartialAsync("_ProductItem", item)
                            }
                        </div>
                    </div>

                    <div id="tab-4" class="tab-pane fade show p-0">
                        <div class="row g-4">
                            @foreach (var item in Model.BestSellerProducts)
                            {
                                @await Html.PartialAsync("_ProductItem", item)
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

@section Scripts{
    <script>
        $(document).ready(function () {
            showCartInfo();
        });
        function addToCart(id) {
            $.ajax({
                url: "/Cart/AddToCart",
                type: "POST", // Quan trọng: Phải là POST để khớp với Controller
                data: { id: id, quantity: 1 }, // Mặc định số lượng là 1 khi bấm ở danh sách
                success: function (response) {
                    if (response.success) {
     
                        showCartInfo();
                        $('#cart-badge-count').text(response.newCartCount);

                        var myModal = new bootstrap.Modal(document.getElementById('addToCartModal'));
                        myModal.show();
                    } else {
                        alert("Lỗi: " + response.message);
                    }
                },
                error: function () {
                    alert("Có lỗi xảy ra khi kết nối đến máy chủ.");
                }
            });
        }
        function showCartInfo() {
        $.ajax({
            url: "/Cart/GetCartInfo",
            type: "GET",
            success: function (data) {
                if (data.count > 0) {
                    $("#cart-global-count").text(data.count).show();
                } else {
                    $("#cart-global-count").hide();
                }
                var formattedTotal = data.total.toLocaleString('vi-VN') + " ₫";
                $("#cart-global-total").text(formattedTotal);
            },
            error: function () {
                console.log("Không thể tải thông tin giỏ hàng");
            }
        });
        }
    </script>
}